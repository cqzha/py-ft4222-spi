from ctypes import *
from enum import IntEnum

WORD = c_ushort
DWORD = c_ulong
LPDWORD = POINTER(DWORD)
CHAR = c_char
UCHAR = c_ubyte
PCHAR = c_char_p
PUCHAR = POINTER(c_ubyte)
FT_HANDLE = PVOID = c_void_p


class FT_DEVICE_LIST_INFO_NODE(Structure):
    _fields_ = [
        ("Flags", DWORD),
        ("Type", DWORD),
        ("ID", DWORD),
        ("LocId", DWORD),
        ("SerialNumber", CHAR*16),
        ("Description", CHAR*64),
        ("ftHandle", DWORD)
    ]


class FT4222_Version(Structure):
    _fields_ = [
        ("chipVersion", DWORD),
        ("dllVersion", DWORD)
    ]


class SPI_Slave_Header(Structure):
    _fields_ = [
        ("syncWord", c_uint8),
        ("cmd", c_uint8),
        ("sn", c_uint8),
        ("size", c_uint8)
    ]


# FT_STATUS
FT_OK = 0
FT_INVALID_HANDLE = 1
FT_DEVICE_NOT_FOUND = 2
FT_DEVICE_NOT_OPENED = 3
FT_IO_ERROR = 4
FT_INSUFFICIENT_RESOURCES = 5
FT_INVALID_PARAMETER = 6
FT_INVALID_BAUD_RATE = 7
FT_DEVICE_NOT_OPENED_FOR_ERASE = 8
FT_DEVICE_NOT_OPENED_FOR_WRITE = 9
FT_FAILED_TO_WRITE_DEVICE = 10
FT_EEPROM_READ_FAILED = 11
FT_EEPROM_WRITE_FAILED = 12
FT_EEPROM_ERASE_FAILED = 13
FT_EEPROM_NOT_PRESENT = 14
FT_EEPROM_NOT_PROGRAMMED = 15
FT_INVALID_ARGS = 16
FT_NOT_SUPPORTED = 17
FT_OTHER_ERROR = 18

# Flags (FT_ListDevices)
FT_LIST_NUMBER_ONLY = 0x80000000
FT_LIST_BY_INDEX = 0x40000000
FT_LIST_ALL = 0x20000000

# Flags (FT_OpenEx)
FT_OPEN_BY_SERIAL_NUMBER = 1
FT_OPEN_BY_DESCRIPTION = 2
FT_OPEN_BY_LOCATION = 4

# Purge RX and TX Buffers (FT_Purge)
FT_PURGE_RX = 1
FT_PURGE_TX = 2

# Notification Events (FT_SetEventNotification)
FT_EVENT_RXCHAR = 1
FT_EVENT_MODEM_STATUS = 2
FT_EVENT_LINE_STATUS = 4

# Bit Modes (FT_SetBitMode)
FT_BITMODE_RESET = 0x00
FT_BITMODE_ASYNC_BITBANG = 0x01
FT_BITMODE_MPSSE = 0x02
FT_BITMODE_SYNC_BITBANG = 0x04
FT_BITMODE_MCU_HOST = 0x08
FT_BITMODE_FAST_SERIAL = 0x10
FT_BITMODE_CBUS_BITBANG = 0x20
FT_BITMODE_SYNC_FIFO = 0x40

# FT4222_STATUS
FT4222_OK = 0
FT4222_INVALID_HANDLE = 1
FT4222_DEVICE_NOT_FOUND = 2
FT4222_DEVICE_NOT_OPENED = 3
FT4222_IO_ERROR = 4
FT4222_INSUFFICIENT_RESOURCES = 5
FT4222_INVALID_PARAMETER = 6
FT4222_INVALID_BAUD_RATE = 7
FT4222_DEVICE_NOT_OPENED_FOR_ERASE = 8
FT4222_DEVICE_NOT_OPENED_FOR_WRITE = 9
FT4222_FAILED_TO_WRITE_DEVICE = 10
FT4222_EEPROM_READ_FAILED = 11
FT4222_EEPROM_WRITE_FAILED = 12
FT4222_EEPROM_ERASE_FAILED = 13
FT4222_EEPROM_NOT_PRESENT = 14
FT4222_EEPROM_NOT_PROGRAMMED = 15
FT4222_INVALID_ARGS = 16
FT4222_NOT_SUPPORTED = 17
FT4222_OTHER_ERROR = 18
FT4222_DEVICE_LIST_NOT_READY = 19

# FT_STATUS extending message
FT4222_DEVICE_NOT_SUPPORTED = 1000
FT4222_CLK_NOT_SUPPORTED = 1001
FT4222_VENDER_CMD_NOT_SUPPORTED = 1002
FT4222_IS_NOT_SPI_MODE = 1003
FT4222_IS_NOT_I2C_MODE = 1004
FT4222_IS_NOT_SPI_SINGLE_MODE = 1005
FT4222_IS_NOT_SPI_MULTI_MODE = 1006
FT4222_WRONG_I2C_ADDR = 1007
FT4222_INVAILD_FUNCTION = 1008
FT4222_INVALID_POINTER = 1009
FT4222_EXCEEDED_MAX_TRANSFER_SIZE = 1010
FT4222_FAILED_TO_READ_DEVICE = 1011
FT4222_I2C_NOT_SUPPORTED_IN_THIS_MODE = 1012
FT4222_GPIO_NOT_SUPPORTED_IN_THIS_MODE = 1013
FT4222_GPIO_EXCEEDED_MAX_PORTNUM = 1014
FT4222_GPIO_WRITE_NOT_SUPPORTED = 1015
FT4222_GPIO_PULLUP_INVALID_IN_INPUTMODE = 1016
FT4222_GPIO_PULLDOWN_INVALID_IN_INPUTMODE = 1017
FT4222_GPIO_OPENDRAIN_INVALID_IN_OUTPUTMODE = 1018
FT4222_INTERRUPT_NOT_SUPPORTED = 1019
FT4222_GPIO_INPUT_NOT_SUPPORTED = 1020
FT4222_EVENT_NOT_SUPPORTED = 1021
FT4222_FUN_NOT_SUPPORT = 1022


# FT4222_ClockRate
class FT4222_ClockRate(IntEnum):
    SYS_CLK_60 = 0
    SYS_CLK_24 = 1
    SYS_CLK_48 = 2
    SYS_CLK_80 = 3


# FT4222_FUNCTION
class FT4222_Function(IntEnum):
    FT4222_I2C_MASTER = 1
    FT4222_I2C_SLAVE = 2
    FT4222_SPI_MASTER = 3
    FT4222_SPI_SLAVE = 4


# FT4222_SPIMode
class FT4222_SpiMode(IntEnum):
    SPI_IO_NONE = 0
    SPI_IO_SINGLE = 1
    SPI_IO_DUAL = 2
    SPI_IO_QUAD = 4


# FT4222_SPIClock
class FT4222_SpiClock(IntEnum):
    CLK_NONE = 0
    CLK_DIV_2 = 1
    CLK_DIV_4 = 2
    CLK_DIV_8 = 3
    CLK_DIV_16 = 4
    CLK_DIV_32 = 5
    CLK_DIV_64 = 6
    CLK_DIV_128 = 7
    CLK_DIV_256 = 8
    CLK_DIV_512 = 9


# FT4222_SPICPOL 时钟极性
class FT4222_SpiCpol(IntEnum):
    CLK_IDLE_LOW = 0
    CLK_IDLE_HIGH = 1


# FT4222_SPICPHA 时钟相位
class FT4222_SpiCpha(IntEnum):
    CLK_LEADING = 0
    CLK_TRAILING = 1


# SPI_DrivingStrength
class SPI_DrivingStrength(IntEnum):
    DS_4MA = 0
    DS_8MA = 1
    DS_12MA = 2
    DS_16MA = 4


# SPI_ChipSelect
class Spi_ChipSelect(IntEnum):
    CS_ACTIVE_LOW = 0
    CS_ACTIVE_HIGH = 1


# GPIO_Port
class GPIO_Port(IntEnum):
    GPIO_PORT0 = 0
    GPIO_PORT1 = 1
    GPIO_PORT2 = 2
    GPIO_PORT3 = 3


# GPIO_Dir
class GPIO_direction(IntEnum):
    GPIO_OUTPUT = 0
    GPIO_INPUT = 1


# GPIO_Trigger
class GPIO_Trigger(IntEnum):
    GPIO_TRIGGER_RISING = 0x01
    GPIO_TRIGGER_FALLING = 0x02
    GPIO_TRIGGER_LEVEL_HIGH = 0x04
    GPIO_TRIGGER_LEVEL_LOW = 0X08


# GPIO_Output
class GPIO_Output(IntEnum):
    GPIO_OUTPUT_LOW = 0
    GPIO_OUTPUT_HIGH = 1


# I2C_MasterFlag
class I2C_MasterFlag(IntEnum):
    NONE = 0x80
    START = 0x02
    Repeated_START = 0x03
    STOP = 0x04
    START_AND_STOP = 0x06


# SPI_SlaveProtocol
class SPI_SlaveProtocol(IntEnum):
    SPI_SLAVE_WITH_PROTOCOL = 0
    SPI_SLAVE_NO_PROTOCOL = 1
    SPI_SLAVE_NO_ACK = 2
